<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>ü¶Ä Pinchtab Dashboard</title>
<link rel="stylesheet" href="/dashboard/base.css">
<link rel="stylesheet" href="/dashboard/agents.css">
<link rel="stylesheet" href="/dashboard/profiles.css">
<link rel="stylesheet" href="/dashboard/screencast.css">
<link rel="stylesheet" href="/dashboard/settings.css">

</head>
<body>
<header>
  <h1 class="app-brand">
    <img src="/dashboard/pinchtab-headed-192.png" alt="Pinchtab" class="app-brand-icon">
    <span>Pinchtab</span>
  </h1>
  <div class="status"><span class="dot"></span>Live</div>
  <div class="view-toggle">
    <button class="view-btn active" data-view="profiles" onclick="switchView('profiles')">Profiles</button>
    <button class="view-btn" data-view="feed" onclick="switchView('feed')">Agents</button>
    <button class="view-btn" data-view="settings" onclick="switchView('settings')">Settings</button>
  </div>
</header>


<div id="profiles-view" class="instances-view" style="display:flex">
  <div class="inst-toolbar">
    <button onclick="showCreateProfileModal()" class="launch-btn">New Profile</button>
    <button onclick="loadProfiles()" class="refresh-btn">Refresh</button>
  </div>
  <div id="profiles-grid" class="instances-grid">
    <div class="empty-state"><div class="crab">ü¶Ä</div>No profiles yet.<br>Click <b>+ New Profile</b> to create one.</div>
  </div>
</div>


<div class="modal-overlay" id="create-profile-modal">
  <div class="modal">
    <h3>üìÅ New Profile</h3>
    <label style="color:#888;font-size:12px;display:block;margin-bottom:4px">Name</label>
    <input id="create-name" placeholder="e.g. personal, work, scraping" />
    <label style="color:#888;font-size:12px;display:block;margin-bottom:4px">Use this profile when (helps agents pick the right profile)</label>
    <textarea id="create-usewhen" placeholder="e.g. I need to access Gmail for the team account" style="min-height:60px"></textarea>
    <label style="color:#888;font-size:12px;display:block;margin-bottom:4px">Import from (optional ‚Äî Chrome user data path)</label>
    <input id="create-source" placeholder="e.g. /Users/you/Library/Application Support/Google/Chrome" />
    <div class="btn-row" style="margin-top:16px">
      <button class="secondary" onclick="closeCreateProfileModal()">Cancel</button>
      <button onclick="doCreateProfile()">Create</button>
    </div>
  </div>
</div>


<div class="modal-overlay" id="confirm-modal">
  <div class="modal">
    <h3 id="confirm-title">Confirm</h3>
    <p id="confirm-message" style="color:#ccc;margin:12px 0 20px;font-size:14px;line-height:1.5"></p>
    <div class="btn-row">
      <button class="secondary" id="confirm-cancel">Cancel</button>
      <button class="danger" id="confirm-ok">Confirm</button>
    </div>
  </div>
</div>


<div class="modal-overlay" id="launch-modal">
  <div class="modal">
    <h3>üñ•Ô∏è Launch Profile</h3>
    <input id="launch-name" type="hidden" />
    <input id="launch-profile-path" type="hidden" />
    <label style="color:#888;font-size:12px;display:block;margin-bottom:4px">Port</label>
    <input id="launch-port" placeholder="e.g. 9868" />
    <label class="toggle" style="margin:10px 0 12px;white-space:nowrap">
      <span style="flex:1">Headless ‚Äî best for Docker/VPS</span>
      <input id="launch-headless" type="checkbox" style="width:16px;flex:none;margin:0" />
    </label>
    <label style="color:#888;font-size:12px;display:block;margin-bottom:4px">Direct launch command (backup)</label>
    <textarea id="launch-command" class="launch-command" readonly></textarea>
    <div class="btn-row" style="justify-content:flex-start;margin-top:-2px;margin-bottom:8px">
      <button class="secondary" onclick="copyLaunchCommand()">Copy Command</button>
    </div>
    <div class="btn-row">
      <button class="secondary" onclick="closeLaunchModal()">Cancel</button>
      <button onclick="doLaunch()">Launch</button>
    </div>
  </div>
</div>


<div id="settings-view" class="settings-view" style="display:none">
  <div class="settings-fixed-actions">
    <div class="settings-fixed-actions-inner">
      <button onclick="applySettings()" class="launch-btn">Apply Settings</button>
      <button onclick="loadSettings()" class="refresh-btn">Reset</button>
    </div>
  </div>
  <div class="settings-scroll">
    <div class="settings-container">
      <div class="settings-section">
        <h3>üì∫ Screencast</h3>
        <div class="setting-row">
          <label>Frame Rate</label>
          <div class="setting-control">
            <input type="range" id="set-fps" min="1" max="15" value="1" oninput="document.getElementById('fps-val').textContent=this.value+' fps'">
            <span id="fps-val" class="setting-value">1 fps</span>
          </div>
        </div>
        <div class="setting-row">
          <label>Quality</label>
          <div class="setting-control">
            <input type="range" id="set-quality" min="10" max="80" value="30" oninput="document.getElementById('quality-val').textContent=this.value+'%'">
            <span id="quality-val" class="setting-value">30%</span>
          </div>
        </div>
        <div class="setting-row">
          <label>Max Width</label>
          <div class="setting-control">
            <select id="set-maxwidth">
              <option value="400">400px</option>
              <option value="600">600px</option>
              <option value="800" selected>800px</option>
              <option value="1024">1024px</option>
              <option value="1280">1280px</option>
            </select>
          </div>
        </div>
      </div>

      <div class="settings-section">
        <h3>üõ°Ô∏è Stealth</h3>
        <div class="setting-row">
          <label>Level</label>
          <div class="setting-control">
            <select id="set-stealth" onchange="applyStealth()">
              <option value="light">Light (default)</option>
              <option value="full">Full (canvas noise, WebGL, fonts)</option>
            </select>
          </div>
        </div>
        <div id="stealth-info" class="setting-info"></div>
      </div>

      <div class="settings-section">
        <h3>üåê Browser</h3>
        <div class="setting-row">
          <label>Block Images</label>
          <div class="setting-control">
            <label class="toggle"><input type="checkbox" id="set-block-images"><span class="toggle-label">Off</span></label>
          </div>
        </div>
        <div class="setting-row">
          <label>Block Media</label>
          <div class="setting-control">
            <label class="toggle"><input type="checkbox" id="set-block-media"><span class="toggle-label">Off</span></label>
          </div>
        </div>
        <div class="setting-row">
          <label>No Animations</label>
          <div class="setting-control">
            <label class="toggle"><input type="checkbox" id="set-no-animations"><span class="toggle-label">Off</span></label>
          </div>
        </div>
      </div>

      <div class="settings-section">
        <h3>üìä Server Info</h3>
        <div id="server-info" class="server-info">Loading...</div>
      </div>
    </div>
  </div>
</div>


<div id="feed-view" class="container" style="display:none">
  <div class="agents-panel">
    <h2>Agents</h2>
    <div id="agents-list">
      <div class="empty-state">
        <img src="/dashboard/pinchtab-headed-192.png" alt="" class="empty-icon">
        No agents connected yet.<br>Make an API call with <code>X-Agent-Id</code> header.
      </div>
    </div>
  </div>

  <div class="feed-panel">
    <div class="feed-header">
      <h2>Activity Feed</h2>
      <div class="filter-btns">
        <button class="filter-btn active" data-filter="all">All</button>
        <button class="filter-btn" data-filter="navigate">Navigate</button>
        <button class="filter-btn" data-filter="snapshot">Snapshot</button>
        <button class="filter-btn" data-filter="actions">Actions</button>
      </div>
    </div>
    <div id="feed-list" class="feed-list">
      <div class="empty-state">
        <img src="/dashboard/pinchtab-headed-192.png" alt="" class="empty-icon">
        Waiting for events...
      </div>
    </div>
  </div>
</div>


<div class="modal-overlay" id="modal">
  <div class="modal">
    <h3 id="modal-title">Manage Profile</h3>
    <div id="modal-body"></div>
  </div>
</div>

<script src="/dashboard/utils.js"></script>
<script src="/dashboard/agents.js"></script>
<script src="/dashboard/settings.js"></script>
<script src="/dashboard/screencast.js"></script>
<script src="/dashboard/profiles.js"></script>
<script src="/dashboard/app.js"></script>

</body>
</html>
